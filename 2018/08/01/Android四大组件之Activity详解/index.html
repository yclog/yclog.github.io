<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Flat White"><title>Android四大组件之Activity详解 · yclog</title><meta name="description" content="Activity生命周期：
onCreate：在Acitivty第一次创建时调用，用于做初始化的工作onStart：onCreate调用后调用，此次界面对用户来说无法看见onResume：此次界面可见并显示到前台，且当前Acitvity位于当前栈顶，并且处于运行状态onPause：表示当前Activ"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">yclog</a></h3></div></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Android四大组件之Activity详解</a></h3></div><div class="post-content"><h4 id="Activity生命周期："><a href="#Activity生命周期：" class="headerlink" title="Activity生命周期："></a>Activity生命周期：</h4><p><img src="http://img.blog.csdn.net/20170711120007533?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZW5vdWdoX2VtcHR5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>onCreate：在Acitivty第一次创建时调用，用于做初始化的工作<br>onStart：onCreate调用后调用，此次界面对用户来说无法看见<br>onResume：此次界面可见并显示到前台，且当前Acitvity位于当前栈顶，并且处于运行状态<br>onPause：表示当前Activity正在停止，常做一些存储数据、停止动画等工作(不做耗时操作)<br>onStop：表示当前Activity即将停止，一般做微量级的回收工作<br>onDestory：表示当前Activity即将被销毁，可做一些回收工作和最终的资源释放<br>onRestart：表示当前Activity正在重新启动，当前Activity从不可见状态变化为可见状态  </p>
<h4 id="Activity的构成"><a href="#Activity的构成" class="headerlink" title="Activity的构成"></a>Activity的构成</h4><p><img src="http://img.blog.csdn.net/20170711115955775?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZW5vdWdoX2VtcHR5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>PhoneWindow是Window的实现类，而Window之下包含一个DecorView，DecorView实际是页面的顶级视图，开发是设置的布局资源添加到系统布局的mContentParent中，android解析XML方法（SAX、Pull、Dom三种方式）</p>
<h4 id="Activity的四种启动模式-standard-singleTop-singleTask-singleInstance"><a href="#Activity的四种启动模式-standard-singleTop-singleTask-singleInstance" class="headerlink" title="Activity的四种启动模式(standard,singleTop,singleTask,singleInstance)"></a>Activity的四种启动模式(standard,singleTop,singleTask,singleInstance)</h4><p>1：standard(标准启动模式)栈内允许有多个实例，互不影响<br>2：singleTop 当以singleTop为启动模式的Activity再次启动时，如果当前已经有一个实例位于栈顶，当再次调用原来的onNewIntent()函数，栈顶不会新加入一个实例。如果实例不在栈顶，则与standard标准启动一样<br>3：singleTask 如果一个Activity设置了该启动模式，任务栈中只能存在一个该Activity的实例。如果任务栈中存在一个Activity实例，则销毁当前Activity栈内位于实例之前的所有Activity实例，最终让该Activity实例位于栈顶。同时调用该Activity的onNewIntent()函数<br>4：singleInstance 设置singleInstance模式的Activity会在一个单独的任务栈中开启实例，当再次启动该Activity实例时，会重用已存在的任务与实例，并调用该实例的onNewIntent()函数，将intent实例中传递到该实例中</p>
<p><strong>Note:</strong>（仍旧将任务栈中X前的实例全部取消）</p>
<p>  对于singleTask作为启动模式的实例X，有选择其所需要的任务栈，例如本身主任务栈为S1,且当前任务栈中不存在X实例，若所需要的任务栈为S2，且任务栈S2不存在，则创建S2与X实例，并将实例X存入栈S2中<br>  另一种情况下，假设X所需的任务栈为S1，其他情况如上述例子所示，由于S1任务栈已经存在，所以系统会直接创建X的实例并将其导入栈S1中</p>
<p><strong>设置启动模式方法：</strong></p>
<p>第一种：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;activity</span><br><span class="line">    android:name=<span class="string">"com.sample.sampleActivity"</span></span><br><span class="line">    android:launchMode=<span class="string">"singleTask"</span></span><br><span class="line">    android:label=<span class="string">"@string/app_name"</span>/&gt;</span><br></pre></td></tr></table></figure></p>
<p>第二种：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Intent intent=<span class="keyword">new</span> Intent();</span><br><span class="line">intent.setClass(MainActivity.<span class="keyword">this</span>,sampleActivity.class);</span><br><span class="line">intent.addFalgs(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">startActivity(intent);</span><br></pre></td></tr></table></figure></p>
<p><strong>Notes:</strong> 第一种无法直接为Activity设定FALG_ACTIVITY_CLEAR_TOP表示，而第二种方式无法为Activity指定singleInstance模式</p>
<h4 id="Activity的Flags"><a href="#Activity的Flags" class="headerlink" title="Activity的Flags"></a>Activity的Flags</h4><ul>
<li>FALG_ACTIVITY_NEW_TASK（对应Activity的singletask启动模式）</li>
<li>FALG_ACTIVITY_SINGLE_TOP （对应Activity的singletop启动模式）</li>
<li>FALG_ACTIVITY_CLEAR_TOP（具有次标记的Activity，当他启动时，在同一任务栈中所有位于它上面的Activity都要出栈，一般与singleTask启动模式一起出现，如果启动的实例已经存在，系统就会调用onNewIntent）</li>
<li>FALG_ACTIVITY_EXCLUDE_FROM_RESCENTS（具有这个标记的Activity不会出现在历史的Activity的列表中，等同与android:excludeFromRecents=”true”）</li>
</ul>
<h4 id="异常情况下的生命周期分析"><a href="#异常情况下的生命周期分析" class="headerlink" title="异常情况下的生命周期分析"></a>异常情况下的生命周期分析</h4><p><img src="http://img.blog.csdn.net/20170711115934148?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZW5vdWdoX2VtcHR5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>1、情况1：资源相关的系统配置发生改变导致Activity被杀死并重新创建<br>横竖屏突然转换，在默认情况下，Activity就会被销毁并且重新创建，系统先调用onSaveInstanceSate来保存当前Activity的状态。该方法调用在onStop之前，与onPause没有时序关系。当Activity在被重新创建之后，系统会调用onRestoreInstanceSate和onCreate方法来判断Activity是否被创建了，如果被重建了，那么我们就可以取出之前保存的数据并恢复，从时序上来说，onRestoreInstanceSate的调用在onStart上。类似TextView源码中包含onSaveInstanceSate方法保存控件内容。在AndroidManifest文件中设置android:configChanges=”orientation”保证屏幕方向固定，此时即使手机旋转界面仍旧保持原来方向不发生改变<br></p>
<p>2、情况2：Activity按照优先级从高到低，可以分为如下三种<br>(1) 前台Activity—正在和用户交互的Activity，优先级最高<br>(2) 可见但非前台Activity—比如Activity中弹出一个对话框，则背后的Activity就是属于这种情况，可见但位于后台无法与用户直接交互<br>(3) 后台Activity—已经被暂停的Activity，比如执行了onStop，优先级最低。</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-08-01</span><i class="fa fa-tag"></i><a class="tag" href="/tags/Android/" title="Android">Android </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,yclog.github.io/2018/08/01/Android四大组件之Activity详解/,yclog,Android四大组件之Activity详解,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2018/08/01/Android机制之Handler解析/" title="Android机制之Handler解析">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/08/01/Git添加SSH-Key/" title="Git添加SSH Key">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>